<?xml version="1.0" encoding="UTF-8"?>
<!--<beans xmlns="http://www.springframework.org/schema/beans"-->
<!--       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"-->
<!--       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">-->

<!--</beans>-->
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.e114.e114_eumyuratodemo1.jdbc.AdminMemberDAO">
    <select id="getArtistMembers" resultType="com.e114.e114_eumyuratodemo1.dto.ArtistMemberDTO">
        select id, name, nid, sex, birth, phone, genre
        from artist_member
    </select>

    <select id="getCommonMembers" resultType="com.e114.e114_eumyuratodemo1.dto.CommonMemberDTO">
        select id, name, nid, sex, birth, phone, genre
        from common_member
    </select>

    <select id="getEntMembers" resultType="com.e114.e114_eumyuratodemo1.dto.EnterpriseMemberDTO">
        select id, name, num, email, phone
        from enterprise_member
    </select>

    <select id="searchArtistMembers" parameterType="map" resultType="com.e114.e114_eumyuratodemo1.dto.ArtistMemberDTO">
        SELECT id, name, nid, sex, birth, phone, genre FROM artist_member
        WHERE ${column2} LIKE CONCAT('%', #{keyword2}, '%')
    </select>

    <select id="searchCommonMembers" parameterType="map" resultType="com.e114.e114_eumyuratodemo1.dto.CommonMemberDTO">
        SELECT id, name, nid, sex, birth, phone, genre FROM common_member
        WHERE ${column} LIKE CONCAT('%', #{keyword}, '%')
    </select>

    <select id="searchEntMembers" parameterType="map" resultType="com.e114.e114_eumyuratodemo1.dto.EnterpriseMemberDTO">
        SELECT id, name, num, email, phone FROM enterprise_member
        WHERE ${column3} LIKE CONCAT('%', #{keyword3}, '%')
    </select>

    <select id="getReservationList" resultType="com.e114.e114_eumyuratodemo1.dto.ReservationDTO">
        SELECT * FROM reservation
    </select>

    <select id="searchReservations" parameterType="map" resultType="com.e114.e114_eumyuratodemo1.dto.ReservationDTO">
        SELECT id, sid, cid, payTime, viewDate, memberNum, reservPay
        FROM reservation
        WHERE 1 = 1
        <if test="column == 'cid'">
            AND cid = #{keyword}
        </if>
        <if test="column == 'sid'">
            AND sid = #{keyword}
        </if>
    </select>
    
    <select id="getAdminInfoById" resultType="com.e114.e114_eumyuratodemo1.dto.EnterpriseMemberDTO">
        SELECT id, pwd, name, num, email, phone
        FROM enterprise_member
        WHERE id = #{id} AND adminNum = 0
    </select>

    <select id="getBuskings" resultType="com.e114.e114_eumyuratodemo1.dto.BuskingDTO">
        select * from busking
    </select>

    <select id="getSmallConcerts" resultType="com.e114.e114_eumyuratodemo1.dto.SmallConcertDTO">
        select * from small_concert
    </select>

    <select id="getLocalFestivals" resultType="com.e114.e114_eumyuratodemo1.dto.LocalFestivalDTO">
        select * from local_festival
    </select>

    <select id="searchBuskings" resultType="com.e114.e114_eumyuratodemo1.dto.BuskingDTO">
        SELECT * FROM busking WHERE ${column} LIKE CONCAT('%', #{keyword}, '%')
    </select>

    <select id="searchSmallConcerts" resultType="com.e114.e114_eumyuratodemo1.dto.SmallConcertDTO">
        SELECT * FROM small_concert WHERE ${column} LIKE CONCAT('%', #{keyword}, '%')
    </select>

    <select id="searchLocalFestivals" resultType="com.e114.e114_eumyuratodemo1.dto.LocalFestivalDTO">
        SELECT * FROM local_festival WHERE ${column} LIKE CONCAT('%', #{keyword}, '%')
    </select>

    <insert id="registerSmallConcert">
        insert into small_concert(name, enterId, location, pname, startDate, lastDate, price, image) values (#{name}, #{enterId},#{location}, #{pname}, #{startDate}, #{lastDate}, #{price}, #{image})
    </insert>

    <delete id="deleteBusking">
        DELETE FROM busking WHERE id = #{param1}
    </delete>

    <delete id="deleteSmallConcert">
        DELETE FROM small_concert WHERE id = #{param1}
    </delete>

    <delete id="deleteLocalFestival">
        DELETE FROM local_festival WHERE id = #{param1}
    </delete>

    <insert id="saveConcertWithoutImage" parameterType="com.e114.e114_eumyuratodemo1.dto.SmallConcertDTO">
        INSERT INTO small_concert (name, pname, location, enterId, startDate, lastDate, price)
        VALUES (#{name}, #{pname}, #{location}, #{enterId}, #{startDate}, #{lastDate}, #{price})
    </insert>

    <insert id="saveConcert" parameterType="com.e114.e114_eumyuratodemo1.dto.SmallConcertDTO">
        INSERT INTO small_concert (enterId, name, location, pname, price, startDate, lastDate, image)
        VALUES (#{enterId}, #{name}, #{location}, #{pname}, #{price}, #{startDate}, #{lastDate}, #{image})
    </insert>
</mapper>